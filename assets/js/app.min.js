var rdI=(m,i)=>Math.floor(Math.random()*m+i),cv=document.querySelector("canvas"),cvS=608,ctx=cv.getContext("2d"),ut=32,cW=17,cH=15,fd={x:rdI(cW, 1)*ut,y: rdI(cH, 3)*ut},S=[{x:9*ut,y:10*ut}],grd=new Image(),fdI=new Image(),score=0,lastR=0,d,sX,sY,i;cv.width=cv.height=cvS;grd.src="./assets/img/ground.png";fdI.src="./assets/img/food.png";function draw(ts){var reqID=requestAnimationFrame(draw); if(ts-lastR>=100){lastR=ts;ctx.drawImage(grd,0,0);for(i=0;i<S.length;i++){ctx.fillStyle=(i==0)?"rgb(102,0,255)":`rgba(153, 75, 255,${1-i*.02})`;ctx.fillRect(S[i].x,S[i].y,ut,ut);ctx.strokeStyle="red";ctx.strokeRect(S[i].x,S[i].y,ut,ut);}ctx.drawImage(fdI,fd.x,fd.y); sX=S[0].x; sY=S[0].y;switch(d){case "LEFT": if (sX<ut+1)sX=cvS-ut*2;else sX-=ut;break;case "RIGHT": if(sX>=cvS-ut*2)sX=ut;else sX+=ut;break;case "UP": if(sY<=ut*3)sY=cvS-ut*2;else sY-=ut;break;case"DOWN": if(sY>cvS-ut*3)sY=ut*3;else sY+=ut;break;}if(sX==fd.x && sY==fd.y){score++;while(S.some(s=>s.x==fd.x||s.y==fd.y)){fd.x=rdI(cW, 1)*ut;fd.y=rdI(cH, 3)*ut;}}else S.pop();var newH={x:sX,y:sY};if(S.length>=4&&S.some(s=>s.x==newH.x&&s.y==newH.y)){cancelAnimationFrame(reqID);alert("GAME OVER");if(confirm("Play again?"))location.reload();}S.unshift(newH);ctx.fillStyle="white";ctx.font="45px Changa one";ctx.fillText(score,2*ut,1.6*ut)}}requestAnimationFrame(draw);document.addEventListener("keydown",e=>{switch(e.key){case"ArrowLeft":d=(d !="RIGHT")?"LEFT":d;break;case "ArrowRight":d=(d!="LEFT")?"RIGHT":d;break;case "ArrowUp":d=(d!="DOWN")?"UP":d;break;case "ArrowDown":d=(d!="UP")?"DOWN":d;break;}});